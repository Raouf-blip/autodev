name: actions

on:
  push:
    branches: ["feature"]

jobs:
  workflow:
    runs-on: ubuntu-latest
    steps:
      - uses: shivammathur/setup-php@v2
        with:
          php-version: '8.3'
      - uses: actions/checkout@v4
      - name: echo for test
        run: echo "FICHIER de CI/CD bien execut√©"
      - name: Copy .env
        run: |
          echo "cp .env"
          cp ../../cours4/td_backend/.env.ci ../../cours4/td_backend/.env
      - name: Install Dependencies
        run: |
          echo "Install Dependencies"
          composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist
      - name: Process build
        run: |
          echo "build..."
      - name: Run Tests via PHPUnit
        continue-on-error: false
        run: |
          echo "Run Tests via PHPUnit"
          composer run test
      - name: execute linter via phpstan
        continue-on-error: false
        run: |
          echo "execute linter via phpstan"
          composer run phpstan
